<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>Sprite</title>
</head>

<body>
	<canvas id="myCanvas" width="300" height="300" style="border:solid 3px blue">
		Your browser does not support HTML5 Canvas.
	</canvas>
	<script>
		const canvas = document.querySelector('#myCanvas');
		const ctx = canvas.getContext("2d");

		const W = canvas.width, H = canvas.height;

		const spriteList = [
			"leftArm", "legs", "torso", "rightArm",
			"head", "hair", "leftArm-jump", "legs-jump", "rightArm-jump"
		];

		loadImages(spriteList);

		function loadImages(names) {
			let loaded = 0;
			names.forEach(name => {
				const img = new Image();
				img.src = `images/${name}.png`;
				img.onload = () => {
					character.images[name] = img;
					if (++loaded === names.length)
						setInterval(render, 1000 / 15)
					console.log(loaded);
				};
			});
		}

		//Character parameters
		const character = {
			images: {},
			x: 120,
			y: 250,
			jumping: false,
			jumpHeight: 40, // peak jump (pixels)
			jumpTimer: 0, // ms since jump start
			jumpDuration: 600, // total jump duration in ms
			breathAmt: 0,
			breathInc: 0.5,
			breathMax: 4
		};
		

		function render() {
			ctx.clearRect(0, 0, W, H); // clears the canvas

			// breathing
			character.breathAmt += character.breathInc;
			if (
				character.breathAmt > character.breathMax ||
				character.breathAmt < -character.breathMax
			)
				character.breathInc = -character.breathInc;

			const breath = Math.round(character.breathAmt);

			let jumpOffset = 0;
			if (character.jumping) {
				character.jumpTimer += 1000 / 15; 
				const t = character.jumpTimer / character.jumpDuration; 
				if (t >= 1) {
					character.jumping = false;
					character.jumpTimer = 0;
				} else {
					const parab = 4 * t * (1 - t); // peak at t=0.5
					jumpOffset = -parab * character.jumpHeight; // negative => up
				}
			}

			// choose jump sprites during jump when available
			const legsImg = character.jumping && character.images["legs-jump"] ? character.images["legs-jump"] : character.images["legs"];
			const leftArmImg = character.jumping && character.images["leftArm-jump"] ? character.images["leftArm-jump"] : character.images["leftArm"];
			const rightArmImg = character.jumping && character.images["rightArm-jump"] ? character.images["rightArm-jump"] : character.images["rightArm"];

			// draw (apply both breath and jump offsets where appropriate)
			ctx.drawImage(legsImg, character.x, character.y + jumpOffset);
			ctx.drawImage(leftArmImg, character.x + 40, character.y - 42 + breath + jumpOffset);
			ctx.drawImage(character.images["torso"], character.x, character.y - 50 + jumpOffset);
			ctx.drawImage(rightArmImg, character.x - 15, character.y - 42 + breath + jumpOffset);
			ctx.drawImage(character.images["head"], character.x - 10, character.y - 125 + breath + jumpOffset);
			ctx.drawImage(character.images["hair"], character.x - 37, character.y - 138 + breath + jumpOffset);
		}

			canvas.addEventListener("click", (event) => {
				if (!character.jumping) {
					character.jumping = true;
					character.jumpTimer = 0; // start jump
				}
			});
	</script>
</body>

</html>